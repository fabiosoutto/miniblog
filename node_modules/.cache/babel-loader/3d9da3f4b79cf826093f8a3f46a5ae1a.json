{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect, useReducer } from \"react\";\nimport { db } from \"../firebase/config\";\nimport { doc, deleteDoc } from \"firebase/firestore\";\nconst initialState = {\n  loading: null,\n  error: null\n};\n\nconst deleteReducer = (state, action) => {\n  switch (action.type) {\n    case \"LOADING\":\n      return {\n        loading: true,\n        error: null\n      };\n\n    case \"DELETED_DOC\":\n      return {\n        loading: false,\n        error: null\n      };\n\n    case \"ERROR\":\n      return {\n        loading: false,\n        error: action.payload\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport const useDeleteDocument = docCollection => {\n  _s();\n\n  const [response, dispatch] = useReducer(deleteReducer, initialState); // deal with memory leak\n\n  const [cancelled, setCancelled] = useState(false);\n\n  const checkCancelBeforeDispatch = action => {\n    if (!cancelled) {\n      dispatch(action);\n    }\n  };\n\n  const deleteDocument = async id => {\n    checkCancelBeforeDispatch({\n      type: \"LOADING\"\n    });\n\n    try {\n      const deletedDocument = await deleteDoc(doc(db, docCollection, id));\n      checkCancelBeforeDispatch({\n        type: \"DELETED_DOC\",\n        payload: deletedDocument\n      });\n    } catch (error) {\n      checkCancelBeforeDispatch({\n        type: \"ERROR\",\n        payload: error.message\n      });\n    }\n  };\n\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return {\n    deleteDocument,\n    response\n  };\n};\n\n_s(useDeleteDocument, \"aGpufD8as+miNYZKmGUYm2CUF6M=\");","map":{"version":3,"names":["useState","useEffect","useReducer","db","doc","deleteDoc","initialState","loading","error","deleteReducer","state","action","type","payload","useDeleteDocument","docCollection","response","dispatch","cancelled","setCancelled","checkCancelBeforeDispatch","deleteDocument","id","deletedDocument","message"],"sources":["C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/miniblog/src/hooks/useDeleteDocument.js"],"sourcesContent":["import { useState, useEffect, useReducer } from \"react\";\r\nimport { db } from \"../firebase/config\";\r\nimport { doc, deleteDoc } from \"firebase/firestore\";\r\n\r\nconst initialState = {\r\n  loading: null,\r\n  error: null,\r\n};\r\n\r\nconst deleteReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"LOADING\":\r\n      return { loading: true, error: null };\r\n    case \"DELETED_DOC\":\r\n      return { loading: false, error: null };\r\n    case \"ERROR\":\r\n      return { loading: false, error: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport const useDeleteDocument = (docCollection) => {\r\n  const [response, dispatch] = useReducer(deleteReducer, initialState);\r\n\r\n  // deal with memory leak\r\n  const [cancelled, setCancelled] = useState(false);\r\n\r\n  const checkCancelBeforeDispatch = (action) => {\r\n    if (!cancelled) {\r\n      dispatch(action);\r\n    }\r\n  };\r\n\r\n  const deleteDocument = async (id) => {\r\n    checkCancelBeforeDispatch({ type: \"LOADING\" });\r\n\r\n    try {\r\n      const deletedDocument = await deleteDoc(doc(db, docCollection, id));\r\n\r\n      checkCancelBeforeDispatch({\r\n        type: \"DELETED_DOC\",\r\n        payload: deletedDocument,\r\n      });\r\n    } catch (error) {\r\n      checkCancelBeforeDispatch({ type: \"ERROR\", payload: error.message });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    return () => setCancelled(true);\r\n  }, []);\r\n\r\n  return { deleteDocument, response };\r\n};\r\n"],"mappings":";;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,UAA9B,QAAgD,OAAhD;AACA,SAASC,EAAT,QAAmB,oBAAnB;AACA,SAASC,GAAT,EAAcC,SAAd,QAA+B,oBAA/B;AAEA,MAAMC,YAAY,GAAG;EACnBC,OAAO,EAAE,IADU;EAEnBC,KAAK,EAAE;AAFY,CAArB;;AAKA,MAAMC,aAAa,GAAG,CAACC,KAAD,EAAQC,MAAR,KAAmB;EACvC,QAAQA,MAAM,CAACC,IAAf;IACE,KAAK,SAAL;MACE,OAAO;QAAEL,OAAO,EAAE,IAAX;QAAiBC,KAAK,EAAE;MAAxB,CAAP;;IACF,KAAK,aAAL;MACE,OAAO;QAAED,OAAO,EAAE,KAAX;QAAkBC,KAAK,EAAE;MAAzB,CAAP;;IACF,KAAK,OAAL;MACE,OAAO;QAAED,OAAO,EAAE,KAAX;QAAkBC,KAAK,EAAEG,MAAM,CAACE;MAAhC,CAAP;;IACF;MACE,OAAOH,KAAP;EARJ;AAUD,CAXD;;AAaA,OAAO,MAAMI,iBAAiB,GAAIC,aAAD,IAAmB;EAAA;;EAClD,MAAM,CAACC,QAAD,EAAWC,QAAX,IAAuBf,UAAU,CAACO,aAAD,EAAgBH,YAAhB,CAAvC,CADkD,CAGlD;;EACA,MAAM,CAACY,SAAD,EAAYC,YAAZ,IAA4BnB,QAAQ,CAAC,KAAD,CAA1C;;EAEA,MAAMoB,yBAAyB,GAAIT,MAAD,IAAY;IAC5C,IAAI,CAACO,SAAL,EAAgB;MACdD,QAAQ,CAACN,MAAD,CAAR;IACD;EACF,CAJD;;EAMA,MAAMU,cAAc,GAAG,MAAOC,EAAP,IAAc;IACnCF,yBAAyB,CAAC;MAAER,IAAI,EAAE;IAAR,CAAD,CAAzB;;IAEA,IAAI;MACF,MAAMW,eAAe,GAAG,MAAMlB,SAAS,CAACD,GAAG,CAACD,EAAD,EAAKY,aAAL,EAAoBO,EAApB,CAAJ,CAAvC;MAEAF,yBAAyB,CAAC;QACxBR,IAAI,EAAE,aADkB;QAExBC,OAAO,EAAEU;MAFe,CAAD,CAAzB;IAID,CAPD,CAOE,OAAOf,KAAP,EAAc;MACdY,yBAAyB,CAAC;QAAER,IAAI,EAAE,OAAR;QAAiBC,OAAO,EAAEL,KAAK,CAACgB;MAAhC,CAAD,CAAzB;IACD;EACF,CAbD;;EAeAvB,SAAS,CAAC,MAAM;IACd,OAAO,MAAMkB,YAAY,CAAC,IAAD,CAAzB;EACD,CAFQ,EAEN,EAFM,CAAT;EAIA,OAAO;IAAEE,cAAF;IAAkBL;EAAlB,CAAP;AACD,CAhCM;;GAAMF,iB"},"metadata":{},"sourceType":"module"}