{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { db } from '../firebase/config';\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, signOut } from 'firebase/auth';\nimport { useState, useEffect } from 'react';\nexport const useAuthentication = () => {\n  _s();\n\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null); // cleanup\n  // deal with memory leak\n\n  const [cancelled, setCancelled] = useState(false);\n  const auth = getAuth();\n\n  function checkIfIsCancelled() {\n    if (cancelled) {\n      return;\n    }\n  } //Register\n\n\n  const createUser = async data => {\n    checkIfIsCancelled();\n    setLoading(true);\n    setError(null);\n\n    try {\n      const {\n        user\n      } = await createUserWithEmailAndPassword(auth, data.email, data.password);\n      await updateProfile(user, {\n        displayName: data.displayName\n      });\n      setLoading(false);\n      return user;\n    } catch (error) {\n      console.log(error.message);\n      console.log(typeof error.message);\n      let systemErrorMessage;\n\n      if (error.message.includes(\"Password\")) {\n        systemErrorMessage = \"A senha precisa conter ao menos 6 caracteres!\";\n      } else if (error.message.includes(\"email-alredy\")) {\n        systemErrorMessage = \"Email já cadastrado!\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tente mais tarde!\";\n      }\n\n      setLoading(false);\n      setError(systemErrorMessage);\n    }\n  }; //Logout - sign out\n\n\n  const logout = () => {\n    checkIfIsCancelled();\n    signOut(auth);\n  };\n\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return {\n    auth,\n    createUser,\n    error,\n    loading,\n    logout\n  };\n};\n\n_s(useAuthentication, \"xO6KHeiqqCsOzooKHe/mUZTZLjs=\");","map":{"version":3,"names":["db","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","updateProfile","signOut","useState","useEffect","useAuthentication","error","setError","loading","setLoading","cancelled","setCancelled","auth","checkIfIsCancelled","createUser","data","user","email","password","displayName","console","log","message","systemErrorMessage","includes","logout"],"sources":["C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/miniblog/src/hooks/useAuthentication.js"],"sourcesContent":["import { db } from '../firebase/config';\r\n\r\nimport {\r\n    getAuth,\r\n    createUserWithEmailAndPassword,\r\n    signInWithEmailAndPassword,\r\n    updateProfile,\r\n    signOut\r\n} from 'firebase/auth';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\nexport const useAuthentication = () => {\r\n    const [error, setError] = useState(null);\r\n    const [loading, setLoading] = useState(null);\r\n\r\n    // cleanup\r\n    // deal with memory leak\r\n    const [cancelled, setCancelled] = useState(false);\r\n\r\n    const auth = getAuth();\r\n\r\n    function checkIfIsCancelled() {\r\n        if (cancelled) {\r\n            return;\r\n        }\r\n    }\r\n\r\n    //Register\r\n    const createUser = async (data) => {\r\n        checkIfIsCancelled();\r\n\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n\r\n            const {user} = await createUserWithEmailAndPassword(\r\n                auth,\r\n                data.email,\r\n                data.password\r\n            );\r\n            \r\n            await updateProfile(user, {\r\n                displayName: data.displayName\r\n            });\r\n\r\n            setLoading(false);\r\n\r\n            return user;\r\n\r\n        } catch (error) {\r\n\r\n            console.log(error.message);\r\n            console.log(typeof error.message);\r\n\r\n                let systemErrorMessage\r\n\r\n                if(error.message.includes(\"Password\")) {\r\n                    systemErrorMessage = \"A senha precisa conter ao menos 6 caracteres!\";\r\n                } else if(error.message.includes(\"email-alredy\")) {\r\n                    systemErrorMessage = \"Email já cadastrado!\";\r\n                } else {\r\n                    systemErrorMessage = \"Ocorreu um erro, por favor tente mais tarde!\";\r\n                }\r\n\r\n                setLoading(false);\r\n                setError(systemErrorMessage);\r\n            \r\n        }\r\n\r\n        \r\n    };\r\n\r\n    //Logout - sign out\r\n    const logout = () => {\r\n        checkIfIsCancelled();\r\n\r\n        signOut(auth);\r\n    }\r\n\r\n    useEffect(() => {\r\n        return () => setCancelled(true);\r\n    }, []);\r\n\r\n    return {\r\n        auth,\r\n        createUser,\r\n        error,\r\n        loading,\r\n        logout,\r\n    };\r\n};"],"mappings":";;AAAA,SAASA,EAAT,QAAmB,oBAAnB;AAEA,SACIC,OADJ,EAEIC,8BAFJ,EAGIC,0BAHJ,EAIIC,aAJJ,EAKIC,OALJ,QAMO,eANP;AAQA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AAEA,OAAO,MAAMC,iBAAiB,GAAG,MAAM;EAAA;;EACnC,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBJ,QAAQ,CAAC,IAAD,CAAlC;EACA,MAAM,CAACK,OAAD,EAAUC,UAAV,IAAwBN,QAAQ,CAAC,IAAD,CAAtC,CAFmC,CAInC;EACA;;EACA,MAAM,CAACO,SAAD,EAAYC,YAAZ,IAA4BR,QAAQ,CAAC,KAAD,CAA1C;EAEA,MAAMS,IAAI,GAAGd,OAAO,EAApB;;EAEA,SAASe,kBAAT,GAA8B;IAC1B,IAAIH,SAAJ,EAAe;MACX;IACH;EACJ,CAdkC,CAgBnC;;;EACA,MAAMI,UAAU,GAAG,MAAOC,IAAP,IAAgB;IAC/BF,kBAAkB;IAElBJ,UAAU,CAAC,IAAD,CAAV;IACAF,QAAQ,CAAC,IAAD,CAAR;;IAEA,IAAI;MAEA,MAAM;QAACS;MAAD,IAAS,MAAMjB,8BAA8B,CAC/Ca,IAD+C,EAE/CG,IAAI,CAACE,KAF0C,EAG/CF,IAAI,CAACG,QAH0C,CAAnD;MAMA,MAAMjB,aAAa,CAACe,IAAD,EAAO;QACtBG,WAAW,EAAEJ,IAAI,CAACI;MADI,CAAP,CAAnB;MAIAV,UAAU,CAAC,KAAD,CAAV;MAEA,OAAOO,IAAP;IAEH,CAhBD,CAgBE,OAAOV,KAAP,EAAc;MAEZc,OAAO,CAACC,GAAR,CAAYf,KAAK,CAACgB,OAAlB;MACAF,OAAO,CAACC,GAAR,CAAY,OAAOf,KAAK,CAACgB,OAAzB;MAEI,IAAIC,kBAAJ;;MAEA,IAAGjB,KAAK,CAACgB,OAAN,CAAcE,QAAd,CAAuB,UAAvB,CAAH,EAAuC;QACnCD,kBAAkB,GAAG,+CAArB;MACH,CAFD,MAEO,IAAGjB,KAAK,CAACgB,OAAN,CAAcE,QAAd,CAAuB,cAAvB,CAAH,EAA2C;QAC9CD,kBAAkB,GAAG,sBAArB;MACH,CAFM,MAEA;QACHA,kBAAkB,GAAG,8CAArB;MACH;;MAEDd,UAAU,CAAC,KAAD,CAAV;MACAF,QAAQ,CAACgB,kBAAD,CAAR;IAEP;EAGJ,CA3CD,CAjBmC,CA8DnC;;;EACA,MAAME,MAAM,GAAG,MAAM;IACjBZ,kBAAkB;IAElBX,OAAO,CAACU,IAAD,CAAP;EACH,CAJD;;EAMAR,SAAS,CAAC,MAAM;IACZ,OAAO,MAAMO,YAAY,CAAC,IAAD,CAAzB;EACH,CAFQ,EAEN,EAFM,CAAT;EAIA,OAAO;IACHC,IADG;IAEHE,UAFG;IAGHR,KAHG;IAIHE,OAJG;IAKHiB;EALG,CAAP;AAOH,CAhFM;;GAAMpB,iB"},"metadata":{},"sourceType":"module"}