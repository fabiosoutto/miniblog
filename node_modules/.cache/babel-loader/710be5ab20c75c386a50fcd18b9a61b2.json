{"ast":null,"code":"import _regeneratorRuntime from\"C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/10-miniblog/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/10-miniblog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/10-miniblog/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{db}from'../firebase/config';import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,updateProfile,signOut}from'firebase/auth';import{useState,useEffect}from'react';export var useAuthentication=function useAuthentication(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];// cleanup\n// deal with memory leak\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),cancelled=_useState6[0],setCancelled=_useState6[1];var auth=getAuth();function checkIfIsCancelled(){if(cancelled){return;}}//Register\nvar createUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){var _yield$createUserWith,user,systemErrorMessage;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:checkIfIsCancelled();setLoading(true);setError(null);_context.prev=3;_context.next=6;return createUserWithEmailAndPassword(auth,data.email,data.password);case 6:_yield$createUserWith=_context.sent;user=_yield$createUserWith.user;_context.next=10;return updateProfile(user,{displayName:data.displayName});case 10:setLoading(false);return _context.abrupt(\"return\",user);case 14:_context.prev=14;_context.t0=_context[\"catch\"](3);console.log(_context.t0.message);console.log(typeof _context.t0.message);if(_context.t0.message.includes(\"Password\")){systemErrorMessage=\"A senha precisa conter ao menos 6 caracteres!\";}else if(_context.t0.message.includes(\"email-alredy\")){systemErrorMessage=\"Email já cadastrado!\";}else{systemErrorMessage=\"Ocorreu um erro, por favor tente mais tarde!\";}setLoading(false);setError(systemErrorMessage);case 21:case\"end\":return _context.stop();}}},_callee,null,[[3,14]]);}));return function createUser(_x){return _ref.apply(this,arguments);};}();//Logout - sign out\nvar logout=function logout(){checkIfIsCancelled();signOut(auth);};// login - sign in\nvar login=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data){var systemErrorMessage;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:checkIfIsCancelled();setLoading(true);setError(false);_context2.prev=3;_context2.next=6;return signInWithEmailAndPassword(auth,data.email,data.password);case 6:setLoading(false);_context2.next=14;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](3);if(_context2.t0.message.includes(\"user-not-found\")){systemErrorMessage=\"Usuário não encontrado!\";}else if(_context2.t0.message.includes(\"wrong-password\")){systemErrorMessage=\"A senha está incorreta!\";}else{systemErrorMessage=\"Ocorreu um erro, por favor tente mais tarde!\";}setError(systemErrorMessage);setLoading(false);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[3,9]]);}));return function login(_x2){return _ref2.apply(this,arguments);};}();useEffect(function(){return function(){return setCancelled(true);};},[]);return{auth:auth,createUser:createUser,error:error,loading:loading,logout:logout,login:login};};","map":{"version":3,"names":["db","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","updateProfile","signOut","useState","useEffect","useAuthentication","error","setError","loading","setLoading","cancelled","setCancelled","auth","checkIfIsCancelled","createUser","data","email","password","user","displayName","console","log","message","includes","systemErrorMessage","logout","login"],"sources":["C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/10-miniblog/src/hooks/useAuthentication.js"],"sourcesContent":["import { db } from '../firebase/config';\r\n\r\nimport {\r\n    getAuth,\r\n    createUserWithEmailAndPassword,\r\n    signInWithEmailAndPassword,\r\n    updateProfile,\r\n    signOut\r\n} from 'firebase/auth';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\nexport const useAuthentication = () => {\r\n    const [error, setError] = useState(null);\r\n    const [loading, setLoading] = useState(null);\r\n\r\n    // cleanup\r\n    // deal with memory leak\r\n    const [cancelled, setCancelled] = useState(false);\r\n\r\n    const auth = getAuth();\r\n\r\n    function checkIfIsCancelled() {\r\n        if (cancelled) {\r\n            return;\r\n        }\r\n    }\r\n\r\n    //Register\r\n    const createUser = async (data) => {\r\n        checkIfIsCancelled();\r\n\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n\r\n            const {user} = await createUserWithEmailAndPassword(\r\n                auth,\r\n                data.email,\r\n                data.password\r\n            );\r\n            \r\n            await updateProfile(user, {\r\n                displayName: data.displayName\r\n            });\r\n\r\n            setLoading(false);\r\n\r\n            return user;\r\n\r\n        } catch (error) {\r\n\r\n            console.log(error.message);\r\n            console.log(typeof error.message);\r\n\r\n                let systemErrorMessage\r\n\r\n                if(error.message.includes(\"Password\")) {\r\n                    systemErrorMessage = \"A senha precisa conter ao menos 6 caracteres!\";\r\n                } else if(error.message.includes(\"email-alredy\")) {\r\n                    systemErrorMessage = \"Email já cadastrado!\";\r\n                } else {\r\n                    systemErrorMessage = \"Ocorreu um erro, por favor tente mais tarde!\";\r\n                }\r\n\r\n                setLoading(false);\r\n                setError(systemErrorMessage);\r\n            \r\n        }  \r\n    };\r\n\r\n    //Logout - sign out\r\n    const logout = () => {\r\n        checkIfIsCancelled();\r\n\r\n        signOut(auth);\r\n    };\r\n\r\n    // login - sign in\r\n    const login = async(data) => {\r\n\r\n        checkIfIsCancelled();\r\n\r\n        setLoading(true);\r\n        setError(false);\r\n\r\n        try {\r\n\r\n            await signInWithEmailAndPassword(auth, data.email, data.password);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            \r\n            let systemErrorMessage\r\n\r\n            if(error.message.includes(\"user-not-found\")) {\r\n                systemErrorMessage = \"Usuário não encontrado!\"\r\n            } else if(error.message.includes(\"wrong-password\")) {\r\n                systemErrorMessage = \"A senha está incorreta!\"\r\n            } else {\r\n                systemErrorMessage = \"Ocorreu um erro, por favor tente mais tarde!\"\r\n            }\r\n\r\n            setError(systemErrorMessage);\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        return () => setCancelled(true);\r\n    }, []);\r\n\r\n    return {\r\n        auth,\r\n        createUser,\r\n        error,\r\n        loading,\r\n        logout,\r\n        login,\r\n    };\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}