{"ast":null,"code":"import _regeneratorRuntime from\"C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/miniblog/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/miniblog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/miniblog/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useReducer}from\"react\";import{db}from\"../firebase/config\";import{doc,deleteDoc}from\"firebase/firestore\";var initialState={loading:null,error:null};var deleteReducer=function deleteReducer(state,action){switch(action.type){case\"LOADING\":return{loading:true,error:null};case\"DELETED_DOC\":return{loading:false,error:null};case\"ERROR\":return{loading:false,error:action.payload};default:return state;}};export var useDeleteDocument=function useDeleteDocument(docCollection){var _useReducer=useReducer(deleteReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),response=_useReducer2[0],dispatch=_useReducer2[1];// deal with memory leak\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),cancelled=_useState2[0],setCancelled=_useState2[1];var checkCancelBeforeDispatch=function checkCancelBeforeDispatch(action){if(!cancelled){dispatch(action);}};var deleteDocument=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var deletedDocument;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:checkCancelBeforeDispatch({type:\"LOADING\"});_context.prev=1;_context.next=4;return deleteDoc(doc(db,docCollection,id));case 4:deletedDocument=_context.sent;checkCancelBeforeDispatch({type:\"DELETED_DOC\",payload:deletedDocument});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);checkCancelBeforeDispatch({type:\"ERROR\",payload:_context.t0.message});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function deleteDocument(_x){return _ref.apply(this,arguments);};}();useEffect(function(){return function(){return setCancelled(true);};},[]);return{deleteDocument:deleteDocument,response:response};};","map":{"version":3,"names":["useState","useEffect","useReducer","db","doc","deleteDoc","initialState","loading","error","deleteReducer","state","action","type","payload","useDeleteDocument","docCollection","response","dispatch","cancelled","setCancelled","checkCancelBeforeDispatch","deleteDocument","id","deletedDocument","message"],"sources":["C:/xampp/htdocs/Curso ReactJS/Curso ReactJS - Matheus Battisti/Projetos ReactJS/miniblog/src/hooks/useDeleteDocument.js"],"sourcesContent":["import { useState, useEffect, useReducer } from \"react\";\r\nimport { db } from \"../firebase/config\";\r\nimport { doc, deleteDoc } from \"firebase/firestore\";\r\n\r\nconst initialState = {\r\n  loading: null,\r\n  error: null,\r\n};\r\n\r\nconst deleteReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"LOADING\":\r\n      return { loading: true, error: null };\r\n    case \"DELETED_DOC\":\r\n      return { loading: false, error: null };\r\n    case \"ERROR\":\r\n      return { loading: false, error: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport const useDeleteDocument = (docCollection) => {\r\n  const [response, dispatch] = useReducer(deleteReducer, initialState);\r\n\r\n  // deal with memory leak\r\n  const [cancelled, setCancelled] = useState(false);\r\n\r\n  const checkCancelBeforeDispatch = (action) => {\r\n    if (!cancelled) {\r\n      dispatch(action);\r\n    }\r\n  };\r\n\r\n  const deleteDocument = async (id) => {\r\n    checkCancelBeforeDispatch({ type: \"LOADING\" });\r\n\r\n    try {\r\n      const deletedDocument = await deleteDoc(doc(db, docCollection, id));\r\n\r\n      checkCancelBeforeDispatch({\r\n        type: \"DELETED_DOC\",\r\n        payload: deletedDocument,\r\n      });\r\n    } catch (error) {\r\n      checkCancelBeforeDispatch({ type: \"ERROR\", payload: error.message });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    return () => setCancelled(true);\r\n  }, []);\r\n\r\n  return { deleteDocument, response };\r\n};\r\n"],"mappings":"0hBAAA,OAASA,QAAT,CAAmBC,SAAnB,CAA8BC,UAA9B,KAAgD,OAAhD,CACA,OAASC,EAAT,KAAmB,oBAAnB,CACA,OAASC,GAAT,CAAcC,SAAd,KAA+B,oBAA/B,CAEA,GAAMC,aAAY,CAAG,CACnBC,OAAO,CAAE,IADU,CAEnBC,KAAK,CAAE,IAFY,CAArB,CAKA,GAAMC,cAAa,CAAG,QAAhBA,cAAgB,CAACC,KAAD,CAAQC,MAAR,CAAmB,CACvC,OAAQA,MAAM,CAACC,IAAf,EACE,IAAK,SAAL,CACE,MAAO,CAAEL,OAAO,CAAE,IAAX,CAAiBC,KAAK,CAAE,IAAxB,CAAP,CACF,IAAK,aAAL,CACE,MAAO,CAAED,OAAO,CAAE,KAAX,CAAkBC,KAAK,CAAE,IAAzB,CAAP,CACF,IAAK,OAAL,CACE,MAAO,CAAED,OAAO,CAAE,KAAX,CAAkBC,KAAK,CAAEG,MAAM,CAACE,OAAhC,CAAP,CACF,QACE,MAAOH,MAAP,CARJ,CAUD,CAXD,CAaA,MAAO,IAAMI,kBAAiB,CAAG,QAApBA,kBAAoB,CAACC,aAAD,CAAmB,CAClD,gBAA6Bb,UAAU,CAACO,aAAD,CAAgBH,YAAhB,CAAvC,4CAAOU,QAAP,iBAAiBC,QAAjB,iBAEA;AACA,cAAkCjB,QAAQ,CAAC,KAAD,CAA1C,wCAAOkB,SAAP,eAAkBC,YAAlB,eAEA,GAAMC,0BAAyB,CAAG,QAA5BA,0BAA4B,CAACT,MAAD,CAAY,CAC5C,GAAI,CAACO,SAAL,CAAgB,CACdD,QAAQ,CAACN,MAAD,CAAR,CACD,CACF,CAJD,CAMA,GAAMU,eAAc,4FAAG,iBAAOC,EAAP,wIACrBF,yBAAyB,CAAC,CAAER,IAAI,CAAE,SAAR,CAAD,CAAzB,CADqB,sCAIWP,UAAS,CAACD,GAAG,CAACD,EAAD,CAAKY,aAAL,CAAoBO,EAApB,CAAJ,CAJpB,QAIbC,eAJa,eAMnBH,yBAAyB,CAAC,CACxBR,IAAI,CAAE,aADkB,CAExBC,OAAO,CAAEU,eAFe,CAAD,CAAzB,CANmB,+EAWnBH,yBAAyB,CAAC,CAAER,IAAI,CAAE,OAAR,CAAiBC,OAAO,CAAE,YAAMW,OAAhC,CAAD,CAAzB,CAXmB,oEAAH,kBAAdH,eAAc,4CAApB,CAeApB,SAAS,CAAC,UAAM,CACd,MAAO,kBAAMkB,aAAY,CAAC,IAAD,CAAlB,EAAP,CACD,CAFQ,CAEN,EAFM,CAAT,CAIA,MAAO,CAAEE,cAAc,CAAdA,cAAF,CAAkBL,QAAQ,CAARA,QAAlB,CAAP,CACD,CAhCM"},"metadata":{},"sourceType":"module"}